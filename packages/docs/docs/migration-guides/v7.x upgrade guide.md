# 7.x Upgrade Guide

## Breaking changes

### Widget defaultProps.options deprecated in favor of defaultOptions

In order to support React 19 properly, the `mergeWidgetOptions()` function in `@rjsf/utils` `getWidget.tsx` was updated to support a new `defaultOptions` static property.

React 19 [deprecated `defaultProps`](https://react.dev/blog/2024/04/25/react-19#removed-proptypes-and-defaultprops) for function components. To maintain React 19 compatibility, widgets should now use a static `defaultOptions` property instead of `defaultProps.options`.

**Note:** For backwards compatibility, `defaultProps.options` is still supported but **deprecated**. It will be removed in a future major version. You should migrate to the new pattern.

#### Migration

**Before (React 18 and earlier):**

```tsx
import { WidgetProps } from '@rjsf/utils';

function MyCustomWidget(props: WidgetProps) {
  const { options } = props;
  const { color, backgroundColor } = options;
  return <input style={{ color, backgroundColor }} />;
}

// Old pattern - deprecated in React 19
MyCustomWidget.defaultProps = {
  options: {
    color: 'red',
  },
};
```

**After (React 19 compatible):**

```tsx
import { WidgetProps, WidgetWithDefaultOptions } from '@rjsf/utils';

const MyCustomWidget: WidgetWithDefaultOptions = (props: WidgetProps) => {
  const { options } = props;
  const { color, backgroundColor } = options;
  return <input style={{ color, backgroundColor }} />;
};

// New pattern - React 19 compatible
MyCustomWidget.defaultOptions = {
  color: 'red',
};
```

Note the key differences:

1. Use `WidgetWithDefaultOptions` type instead of a plain function
2. Use `defaultOptions` instead of `defaultProps.options`
3. The options are now a flat object directly on the widget, not nested inside `defaultProps`

### react-is.isForwardRef() removed

The usage of `react-is.isForwardRef()` was removed from `getWidget.tsx` because React 19 no longer supports this function. ForwardRef components are now detected using `ReactIs.isValidElementType()`, which provides a robust check for all valid React component types.

This change should be transparent to most users, as the widget detection logic now properly handles:

- Regular function components
- Memoized components (`React.memo`)
- ForwardRef components (`React.forwardRef`)
- Other exotic React components

## New deprecations

None in this release.

## Removed deprecations

None in this release.
