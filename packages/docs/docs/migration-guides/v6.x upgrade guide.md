# 6.x Upgrade Guide

## Breaking changes

### Theme removals

The following themes were removed due to duplication of a framework with a newer theme

#### bootstrap-4

The older `bootstrap-4` theme has been removed in favor of the `react-bootstrap` theme

#### fluent-ui

The older `fluent-ui` theme has been removed in favor of the `fluentui-rc` theme

#### material-ui

The older `material-ui` theme has been removed in favor of the `mui` theme

#### @mui version 5

The `mui` theme no longer supports `@mui` version 5 due to the adoption of breaking changes in version 6

### validator-ajv6

This deprecated validator has been removed. Use the `validator-ajv8`.

### Node support

Version 6 is dropping official support for Node 14, 16, and 18 as they are no longer a [maintained version](https://nodejs.org/en/about/releases/).
Please use Node 22 when making any changes to `package.json` and `package-lock.json` files.
All PR and branch builds are running against Node 20 and 22.

### React version

RJSF is no longer actively supporting React version < 16.14.x.
React 18 is officially supported on all the themes where the underlying theme library also supports React 18.

React 19 support is expected before the end of beta (although several developers have already upgraded with no problems).

### New packages

There is one new packages added in RJSF version 6:

- `@rjsf/react-bootstrap`: This is rename of the `bootstrap-4` theme with an upgrade to the latest version of `react-bootstrap`

### Templates BREAKING CHANGES

#### ArrayFieldTemplateItemType

The type `ArrayFieldTemplateItemType` was deprecated in favor of the `ArrayFieldItemTemplateType` type, which matches the type naming pattern properly.

#### ArrayFieldItemTemplate

The `ArrayFieldItemTemplateType` was refactored to extract the following props into out a new `ArrayFieldItemButtonsTemplateType`:

- `canAdd`: A boolean value stating whether new items can be added to the array.
- `hasCopy`: A boolean value stating whether the array item can be copied.
- `hasMoveDown`: A boolean value stating whether the array item can be moved down.
- `hasMoveUp`: A boolean value stating whether the array item can be moved up.
- `hasRemove`: A boolean value stating whether the array item can be removed.
- `onAddIndexClick: (index) => (event?) => void`: Returns a function that adds a new item at `index`.
- `onDropIndexClick: (index) => (event?) => void`: Returns a function that removes the item at `index`.
- `onReorderClick: (index, newIndex) => (event?) => void`: Returns a function that swaps the items at `index` with `newIndex`.

A new `buttonsProps` prop was added of the type `ArrayFieldItemButtonsTemplateType`

This new type was then used to create a new `ArrayFieldItemButtonsTemplate` in the `Registry.templates`.
See [ArrayFieldItemButtonTemplate](../advanced-customization/custom-templates.md#arrayfielditembuttontemplate)

If you have implemented your own `ArrayFieldItemTemplate` or `ArrayField` then you will have to account for these changes.

#### GridTemplate

A new, theme-dependent template `GridTemplate` was added to support the new layout feature and must be provided if you are building your own `registry.templates` rather than overloading them via the `templates` props.

#### SchemaUtilsType

Five new functions were added to this type, so if you have your own implementation of this type, you will need to add them to yours.
The following new functions match the 5 new validator-based utility API functions mentioned below:

- `findFieldInSchema(path: string | string[], schema: S, formData?: T): FoundFieldType<S>`
- `findSelectedOptionInXxxOf(schema: S, fallbackField: string, xxx: 'anyOf' | `oneOf`, formData?: T): S | undefined;`
- `getFromSchema(schema: S, path: string | string[], defaultValue: T): T;`
- `getFromSchema(schema: S, path: string | string[], defaultValue: S): S;`
- `getFromSchema(schema: S, path: string | string[], defaultValue: T | S): S | T;`

### Other BREAKING CHANGES

#### optionsList

The generics ordering on the `optionsList()` function was changed from `<S, T, F>` to `<T, S, F>` to be consistent with the rest of the APIs.

## New Features

### New types

The following new types were added to `@rjsf/utils`:

- `ArrayFieldItemTemplateType`: The properties of each element in the ArrayFieldTemplateProps.items array. NOTE: `ArrayFieldTemplateItemType` is an alias to this type
- `FoundFieldType`: The interface for the return value of the `findFieldInSchema` function
- `GridTemplateProps`: The properties that are passed to a `GridTemplate`
- `TestIdShape`: The interface for the test ID proxy objects that are returned by the `getTestId` utility function

### New non-validator utility functions

Three new and three formerly internally private utility functions are available in `@rjsf/utils`:

- `buttonId<T>(id: IdSchema<T> | string, btn: 'add' | 'copy' | 'moveDown' | 'moveUp' | 'remove')`: Generates consistent ids for RJSF buttons
- `getTestIds(): TestIdShape`: Returns an object of test IDs that can only be used in test mode, helpful for writing unit tests for React components
- `hashObject(object: unknown): string`: Stringifies an `object` and returns the hash of the resulting string
- `hashString(string: string): string`: Hashes a string into hex format
- `lookupFromFormContext<T = any, S extends StrictRJSFSchema = RJSFSchema, F extends FormContextType = any>(regOrFc: Registry<T, S, F> | Registry<T, S, F>['formContext'], toLookup: string, fallback?: unknown)`: Given a React JSON Schema Form registry or formContext object, return the value associated with `toLookup`
- `sortedJSONStringify(object: unknown): string`: Stringifies an `object`, sorts object fields in consistent order before stringifying it.

### New validator-based utility functions

Three new validator-based utility functions are available in `@rjsf/utils`:

- `findFieldInSchema<T = undefined, S extends StrictRJSFSchema = RJSFSchema, F extends FormContextType = any>(validator: ValidatorType<T, S, F>, rootSchema: S, path: string | string[], schema: S, formData?: T, experimental_customMergeAllOf?: Experimental_CustomMergeAllOf<S>): FoundFieldType<S>`: Finds the field specified by the `path` within the root or recursed `schema`
- `findSelectedOptionInXxxOf<T = any, S extends StrictRJSFSchema = RJSFSchema, F extends FormContextType = any>(validator: ValidatorType<T, S, F>, rootSchema: S, schema: S, fallbackField: string,xxx: 'anyOf' | 'oneOf', formData?: T, experimental_customMergeAllOf?: Experimental_CustomMergeAllOf<S>): S | undefined`: Finds the option that matches the selector field in the `schema` or undefined if nothing is selected
- `getFromSchema<T = any, S extends StrictRJSFSchema = RJSFSchema, F extends FormContextType = any>(validator: ValidatorType<T, S, F>, rootSchema: S, schema: S, path: string | string[], defaultValue: T | S, experimental_customMergeAllOf?: Experimental_CustomMergeAllOf<S>): T | S`: Helper that acts like lodash's `get` but additionally retrieves `$ref`s as needed to get the path for schemas
